<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Workey</title>
  <link href="./css/join.css" rel="stylesheet">
</head>

<body>
  <header>
    <div class="go-back">
      <button type="button">Go back</button>
    </div>
    <h3>Create an account</h3>
  </header>
  <div class="wrapper">
    <div class="container">
      <div class="personal-inform">
        <p class="text-light">First Name</p>
        <div class="div-input">
          <input type="text" id="firstName" oninput="writeData(this.value, 0)">
          <img src="./img/icon_check.svg" class="check-icon">
        </div>
        <p class="text-light">Last Name</p>
        <div class="div-input">
          <input type="text" id="lastName" oninput="writeData(this.value, 1)">
          <img src="./img/icon_check.svg" class="check-icon">
        </div>
        <p class="text-light">Email</p>
        <div class="div-input">
          <input type="text" id="email" oninput="checkEmail(this.value)">
          <img src="./img/icon_check.svg" class="check-icon">
          <img src="./img/icon_warning.svg" id="warning-icon">
        </div>
        <p id="warning-message">Please enter your email address</p>
        <p class="text-light">Password</p>
        <div class="div-input">
          <input type="password" oninput="writeData(this.value, 3)" id="password">
          <img src="./img/icon_check.svg" class="check-icon">
        </div>
        <p class="text-light">Check the password</p>
        <div class="div-input">
          <input type="password" oninput="checkPassword(this.value)" id="check-password">
          <img src="./img/icon_check.svg" class="check-icon">
        </div>
        <p class="text-light" id="text-explan">This information is not publicly displayed.</p>
      </div>
      <div class="company-inform">
        <p class="text-thick">Company : </p>
        <div class="selectBox">
          <img src="./img/icon_company.svg">
          <button class="label" id="company">Google</button>
          <ul class="optionList">
            <li class="optionItem">Google</li>
            <li class="optionItem">Tesla</li>
            <li class="optionItem">Apple</li>
            <li class="optionItem">Amazon</li>
            <li class="optionItem">Meta</li>
            <li class="optionItem">Microsoft</li>
            <li class="optionItem">LG</li>
            <li class="optionItem">Others</li>
          </ul>
        </div>
        <input type="text" id="otherInput" class="other-input" placeholder="Please write here your company">
        <p class="text-thick">Start Time : </p>
        <div class="container-element">
          <img src="./img/icon_start_time.svg">
          <input type="time" id="startTime">
        </div>
        <p class="text-thick">End Time : </p>
        <div class="container-element">
          <img src="./img/icon_end_time.svg">
          <input type="time" id="endTime">
        </div>
        <p class="text-thick">Your Payday : </p>
        <div class="selectBox">
          <img src="./img/icon_calender.svg">
          <button class="label" id="payday">1</button>
          <ul class="optionList">
            <li class="optionItem">1</li>
            <li class="optionItem">2</li>
            <li class="optionItem">3</li>
            <li class="optionItem">4</li>
            <li class="optionItem">5</li>
            <li class="optionItem">6</li>
            <li class="optionItem">7</li>
            <li class="optionItem">8</li>
            <li class="optionItem">9</li>
            <li class="optionItem">10</li>
            <li class="optionItem">11</li>
            <li class="optionItem">12</li>
            <li class="optionItem">13</li>
            <li class="optionItem">14</li>
            <li class="optionItem">15</li>
            <li class="optionItem">16</li>
            <li class="optionItem">17</li>
            <li class="optionItem">18</li>
            <li class="optionItem">19</li>
            <li class="optionItem">20</li>
            <li class="optionItem">21</li>
            <li class="optionItem">22</li>
            <li class="optionItem">23</li>
            <li class="optionItem">24</li>
            <li class="optionItem">25</li>
            <li class="optionItem">26</li>
            <li class="optionItem">27</li>
            <li class="optionItem">28</li>
            <li class="optionItem">29</li>
            <li class="optionItem">30</li>
            <li class="optionItem">31</li>
          </ul>
        </div>
        <button type="submit" onclick="signUp()">Sign up</button>
      </div>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <script src="./js/join.js"></script>
  <script>
    function signUp() {
      let firstName = $('#firstName').val();
      let lastName = $('#lastName').val();
      let email = $('#email').val();
      let password = $('#password').val();
      let checkPassword = $('#check-password').val();
      let company = $('#company').text();
      let startTime = $('#startTime').val();
      let endTime = $('#endTime').val();
      let payday = $('#payday').text();

      console.log(firstName);
      console.log(lastName);
      console.log(email);
      console.log(password);
      console.log(checkPassword);
      console.log(company);
      console.log(startTime);
      console.log(endTime);
      console.log(payday);

      // 공백 확인
      if (firstName === '' ||
        lastName === '' ||
        email === '' ||
        password === '' ||
        checkPassword === '' ||
        startTime === '' ||
        endTime === ''
      ) {
        console.log("입력 필요한 것 있음");
      } else {
        let param = {
          "firstName": firstName,
          "lastName": lastName,
          "email": email,
          "password": password,
          "startTime": startTime,
          "endTime": endTime,
          "company": 1,
          "payday": payday,
          "createdAt": new Date(),
          "updatedAt": new Date()
        };

        $.support.cors = true;
        $.ajax({
          type: 'post',           // 타입 (get, post, put 등등)
          url: `http://localhost:3000/users/join`,           // 요청할 서버url
          async: true,            // 비동기화 여부 (default : true)
          dataType: 'json',       // 데이터 타입 (html, xml, json, text 등등)
          data: JSON.stringify(param),
          contentType: "application/json",
          success: async function (data) { // 결과 성공 콜백함수
            let userId = data.userId;
            console.log("회원가입 성공");
            // location.href = `./index.html?user_id=${userId}`;
            location.href = `./join_completed.html`;
          }
        });
      }
    }
  </script>
</body>

</html>